{"version":3,"sources":["webpack:///./src/components/BlogPosts/AutoLoad.js","webpack:///./src/components/BlogPosts/blogPosts.js","webpack:///./src/pages/blog.js"],"names":["AutoLoad","_Component","apply","arguments","_inheritsLoose","_proto","prototype","componentWillReceiveProps","nextProps","inView","loading","onLoad","loadOff","render","refLink","this","props","React","createElement","ref","style","height","Component","DESKTOP","TABLET","breakpoints","Content","styled","div","timeSince","date","seconds","Math","floor","Date","interval","blogPosts","_this","_len","length","args","Array","_key","call","concat","state","page","chunksPerPage","allLoaded","renderPosts","posts","multiImage","FormatedDate","_toConsumableArray","splice","map","_ref","node","createdAt","Post","key","id","description","imageArr","imageTest","image","title","setState","Button","width","margin","onClick","disabled","InView","_ref2","Blog","data","Layout","header","Head","pageTitle","Header","bg","blog","to","Heading1","BlogPosts","blogs","edges"],"mappings":"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","file":"component---src-pages-blog-js-4cebd6907ab7f7627a0c.js","sourcesContent":["import React, { Component } from 'react'\n\nimport { InView } from 'react-intersection-observer';\n\nexport default class AutoLoad extends Component {\n  componentWillReceiveProps(nextProps) {\n    nextProps.inView && !nextProps.loading && nextProps.onLoad()\n    nextProps.loading && !nextProps.inView && nextProps.loadOff()\n  }\n  render() {\n    const {refLink, inView} = this.props\n    return (\n      <div ref={refLink} style={{ height: '100px'}}>\n        \n      </div>\n    )\n  }\n}\n","import React, { Component } from 'react'\nimport Post from './Post'\nimport styled from 'styled-components'\nimport breakpoints from '../../constants/breakpoints';\nimport AutoLoad from './AutoLoad'\n\nimport { InView } from 'react-intersection-observer';\nimport { Button } from '../utils';\nconst { DESKTOP, TABLET } = breakpoints;\n\nconst Content = styled.div`\n  padding: 5rem;\n  text-align: center;\n  grid-column: center-start / center-end;\n  text-align: initial;\n  display: grid;\n  grid-template-columns: 1fr;\n  @media (max-width: ${DESKTOP}px) {\n    grid-template-columns: 1fr;\n  }\n  @media (max-width: ${TABLET}px) {\n  grid-column: 1 / -1;\n  }\n`\nfunction timeSince(date) {\n\n  var seconds = Math.floor((new Date() - date) / 1000);\n\n  var interval = Math.floor(seconds / 31536000);\n\n  if (interval > 1) {\n    return interval + \" год(а)\";\n  }\n  interval = Math.floor(seconds / 2592000);\n  if (interval >= 1) {\n    return interval + ` ${interval === 1 ? \"месяц\" : \" месяц(а, ев)\"}`;\n  }\n  interval = Math.floor(seconds / 86400);\n  if (interval >= 1) {\n    return interval + ` ${interval === 1 ? \"день\" : \"дн(я, ей)\"}`;\n  }\n  interval = Math.floor(seconds / 3600);\n  if (interval >= 1) {\n    return interval + ` ${interval === 1 ? \"час\" : \" час(а, ов)\"}`;\n  }\n  interval = Math.floor(seconds / 60);\n  if (interval >= 1) {\n    return interval + ` ${interval === 1 ? \" минута\" : \" минут(а, ы)\"}`;\n  }\n  return Math.floor(seconds) + \" секунд(ы)\";\n}\n\nexport default class blogPosts extends Component {\n  state = {\n    page: 1,\n    chunksPerPage: 2,\n    allLoaded: false,\n    loading: false\n  }\n\n  renderPosts = (posts, multiImage) => {\n    var FormatedDate = [...posts]\n    let { page, chunksPerPage } = this.state\n    \n    let ChunkedPosts =  [...FormatedDate.splice(0, page * chunksPerPage )]\n    \n    return ChunkedPosts.map(\n      ({node}) => {\n        FormatedDate = timeSince(new Date(node.createdAt))\n        \n        return <Post \n          key={node.id}\n          date={FormatedDate} \n          description={node.description.description}\n          multiImage={multiImage}\n          imageArr={node.imageTest}\n          image={node.image} \n          title={node.title} \n          />\n      }\n      )\n  }\n\n  onLoad = () => {\n    let { page, chunksPerPage } = this.state\n    let { posts } = this.props\n    let allLoaded = (page + 1) * chunksPerPage >= posts.length\n    this.setState({ page: page + 1, allLoaded: allLoaded, loading: true })\n  }\n\n  render() {\n    const {posts, multiImage} = this.props;\n    const {allLoaded, loading } = this.state;\n    \n    return (\n      <Content>\n        {posts && this.renderPosts(posts, multiImage)}\n        <Button height=\"4rem\" width={'80%'} margin={\"auto\"} onClick={this.onLoad} disabled={allLoaded}>\n          <span>Загрузить еще</span>\n        </Button>\n        <InView>\n        {({ inView, ref }) => (\n          <AutoLoad\n          inView={inView}\n          refLink={ref}\n          onLoad={this.onLoad}\n          loading={loading}\n          loadOff={() => this.setState({loading: false})}\n        />\n        )}\n        </InView>\n      </Content>\n    )\n  }\n}\n","import React from 'react';\nimport { graphql } from 'gatsby';\nimport Layout from 'components/layout';\nimport Head from 'components/head';\nimport Header from 'components/header';\nimport { Heading1, Heading2, DefaultP } from '../components/utils/style';\nimport BlogPosts from '../components/BlogPosts/blogPosts'\n\nconst Blog = ({data}) => (\n  <Layout header={\"small\"}>\n  <Head description={'Узи Центрум Мелитополь Блог'} pageTitle={'Head'} />\n  <Header bg={data.blog.header} to={\"contact/#blog\"}>\n    <Heading1>Наш Блог</Heading1>\n  </Header>\n  <BlogPosts posts={data.blogs.edges} multiImage={data.blog.multiImage}/>\n  </Layout>\n)\n\nexport default Blog\n\nexport const query = graphql`\n{\n    blog: blogJson{\n      multiImage {\n        publicURL\n      }\n      header {\n        image{\n          childImageSharp {\n            fluid(maxWidth: 2000) {\n              ...GatsbyImageSharpFluid_tracedSVG\n            }\n          }\n        }\n      }\n    },\n    blogs:   allContentfulBlogPost(sort: {fields: createdAt, order: DESC}) {\n      edges {\n        node {\n          id\n          title\n          description {\n            description\n          }\n          createdAt\n          imageTest{\n            fluid(maxWidth: 2500) {\n              ...GatsbyContentfulFluid\n              }\n          }\n          image{\n            fluid(maxWidth: 2500) {\n              ...GatsbyContentfulFluid_tracedSVG\n            }\n        }\n      }\n      }\n    }\n  }\n`"],"sourceRoot":""}